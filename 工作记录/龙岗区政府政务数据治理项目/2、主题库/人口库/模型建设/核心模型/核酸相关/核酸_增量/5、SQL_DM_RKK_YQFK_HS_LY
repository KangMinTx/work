MERGE INTO LQGSM.DM_YQ_HSJCJG A
USING (SELECT
ID
,RECEIVE_TIME
,REAL_NAME
,SPECIMEN_CODE
,GENDER
,AGE
,PHONE
,SPECIMEN_TYPE
,COLLECTION_TIME
,REPORT_TIME
,ID_CARD_NO
,COOPERATIVE_INSTITUTION
,CHECK_RESULT
,IMPORT_BATCH
,CREATER
,CREATE_TIME
,TIMEFLAG
,Bz
,wybs
 FROM LQGSM.dm_rkk_syrkfyqk_hsxg_zler_th) B
ON (A.ID_CARD_NO=B.ID_CARD_NO AND substr(A.COLLECTION_TIME,1,10)=substr(B.COLLECTION_TIME,1,10) AND A.REAL_NAME=B.REAL_NAME )
WHEN MATCHED
THEN
  UPDATE SET
  --A.REAL_NAME=B.REAL_NAME
  --A.COLLECTION_TIME=B.COLLECTION_TIME
  --A.ID_CARD_NO=B.ID_CARD_NO
A.ID=B.ID
,A.RECEIVE_TIME=B.RECEIVE_TIME
,A.SPECIMEN_CODE=B.SPECIMEN_CODE
,A.GENDER=B.GENDER
,A.AGE=B.AGE
,A.PHONE=B.PHONE
,A.SPECIMEN_TYPE=B.SPECIMEN_TYPE
,A.REPORT_TIME=B.REPORT_TIME
,A.COOPERATIVE_INSTITUTION=B.COOPERATIVE_INSTITUTION
,A.CHECK_RESULT=B.CHECK_RESULT
,A.IMPORT_BATCH=B.IMPORT_BATCH
,A.CREATER=B.CREATER
,A.CREATE_TIME=B.CREATE_TIME
,A.TIMEFLAG=B.TIMEFLAG
,A.Bz=B.Bz
,A.wybs=B.wybs
WHEN NOT MATCHED
THEN
  INSERT (
 A.ID
,A.RECEIVE_TIME
,A.REAL_NAME
,A.SPECIMEN_CODE
,A.GENDER
,A.AGE
,A.PHONE
,A.SPECIMEN_TYPE
,A.COLLECTION_TIME
,A.REPORT_TIME
,A.ID_CARD_NO
,A.COOPERATIVE_INSTITUTION
,A.CHECK_RESULT
,A.IMPORT_BATCH
,A.CREATER
,A.CREATE_TIME
,A.TIMEFLAG
,A.Bz
,A.wybs)
VALUES (
 B.ID
,B.RECEIVE_TIME
,B.REAL_NAME
,B.SPECIMEN_CODE
,B.GENDER
,B.AGE
,B.PHONE
,B.SPECIMEN_TYPE
,B.COLLECTION_TIME
,B.REPORT_TIME
,B.ID_CARD_NO
,B.COOPERATIVE_INSTITUTION
,B.CHECK_RESULT
,B.IMPORT_BATCH
,B.CREATER
,B.CREATE_TIME
,B.TIMEFLAG
,B.Bz
,B.wybs);
commit;